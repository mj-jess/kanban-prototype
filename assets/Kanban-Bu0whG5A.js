import{a as e,c as t,d as n,f as r,i,l as a,n as o,o as s,p as c,r as l,s as u,t as d,u as f}from"./index-CI0-6VNn.js";var p={board:`_board_psig1_1`,columns:`_columns_psig1_12`},m={column:`_column_4kgd3_51`,columnHeader:`_columnHeader_4kgd3_63`,title:`_title_4kgd3_71`,tasks:`_tasks_4kgd3_76`,isOver:`_isOver_4kgd3_88`,footer:`_footer_4kgd3_92`},h=c();const g=()=>n(),_=r;var v=f();function y({column:e,isEditing:t,closeEditing:n}){let r=g(),[a,o]=(0,h.useState)(``),[s,c]=(0,h.useState)(e.title);return t?(0,v.jsxs)(`form`,{onSubmit:t=>{if(t.preventDefault(),!s.trim()){o(`Campo obrigatório.`);return}r(d.editColumn({id:e.id,title:s})),o(``),n()},className:`form-wrapper`,children:[(0,v.jsx)(`input`,{autoFocus:!0,type:`text`,name:`title`,value:s,className:`form-control`,style:{height:`32px`},onChange:e=>c(e.target.value),onKeyDown:t=>{t.key==`Escape`&&(n(),o(``),c(e.title))}}),a&&(0,v.jsx)(i.caption,{className:`is-invalid`,children:a})]}):(0,v.jsx)(i.h4,{className:`title`,style:{fontSize:`14px`,fontWeight:600,paddingLeft:`0.75rem`},children:e.title})}function b({columnId:e,show:t,closeModal:n}){let r=g(),[a,s]=(0,h.useState)(``),[c,u]=(0,h.useState)(``),[f,p]=(0,h.useState)(!1),m=(0,h.useMemo)(()=>!f||!a.trim()?!0:!!c,[f,a,c]),_=()=>{n(),s(``),p(!1),u(``)};return(0,v.jsxs)(l,{isOpen:t,onClose:n,onSubmit:t=>{t.preventDefault(),r(d.addTask({columnId:e,title:a})),_()},children:[(0,v.jsx)(l.Header,{onClose:n,children:`Adicionar nova Tarefa`}),(0,v.jsx)(l.Body,{children:(0,v.jsxs)(`div`,{className:`form-wrapper`,children:[(0,v.jsx)(i.label,{children:`Nome`}),(0,v.jsx)(`input`,{autoFocus:!0,type:`text`,name:`title`,value:a,className:`form-control`,onChange:e=>{let t=e.target.value;p(!0),s(t),u(t.trim()?``:`Nome é obrigatório.`)}})]})}),(0,v.jsxs)(l.Footer,{children:[(0,v.jsx)(o,{type:`button`,variant:`ghost`,color:`tertiary`,onClick:n,children:`Cancelar`}),(0,v.jsx)(o,{type:`submit`,color:`success`,disabled:m,children:`Adicionar`})]})]})}var x={task:`_task_13gy0_51`,isDragging:`_isDragging_13gy0_69`,title:`_title_13gy0_73`,meta:`_meta_13gy0_79`,taskModal:`_taskModal_13gy0_84`,descriptionWrapper:`_descriptionWrapper_13gy0_84`,description:`_description_13gy0_84`,taskPlaceholder:`_taskPlaceholder_13gy0_97`};function S(e){return u({tag:`svg`,attr:{viewBox:`0 0 20 20`,fill:`currentColor`,"aria-hidden":`true`},child:[{tag:`path`,attr:{fillRule:`evenodd`,d:`M2 4.75A.75.75 0 0 1 2.75 4h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.75Zm0 10.5a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5a.75.75 0 0 1-.75-.75ZM2 10a.75.75 0 0 1 .75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 10Z`,clipRule:`evenodd`},child:[]}]})(e)}var C=({show:e})=>e?(0,v.jsx)(`div`,{className:x.taskPlaceholder}):null;function w({task:e,index:n,columnId:r}){let a=g(),{show:s,openModal:c,closeModal:u}=t(),f=_(e=>e.kanban.columns.find(e=>e.id===r)),p=_(e=>e.kanban.draggingTaskId),[m,y]=(0,h.useState)(e.description||``),[b,w]=(0,h.useState)(!1);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(C,{show:!1}),(0,v.jsx)(`div`,{draggable:!0,className:`${x.task} ${p===e.id?x.isDragging:``}`,onClick:()=>{p||c()},onDragStart:t=>{t.dataTransfer.effectAllowed=`move`,t.dataTransfer.setData(`taskId`,String(e.id)),t.dataTransfer.setData(`fromColumn`,String(r)),a(d.setDraggingTask(e.id))},onDragEnd:()=>{a(d.setDraggingTask(null))},children:(0,v.jsx)(i.p,{className:x.title,children:e.title})}),(0,v.jsx)(C,{show:!1}),(0,v.jsxs)(l,{isOpen:s,onClose:u,onSubmit:e=>{e.preventDefault()},className:x.taskModal,children:[(0,v.jsx)(l.Header,{onClose:u,children:f?.title}),(0,v.jsxs)(l.Body,{children:[(0,v.jsx)(i.h4,{children:e.title}),(0,v.jsxs)(`div`,{className:x.descriptionWrapper,children:[(0,v.jsxs)(i.p,{className:x.description,children:[(0,v.jsx)(S,{}),`Descrição`]}),(0,v.jsx)(o,{type:`button`,color:`tertiary`,onClick:()=>w(!0),children:`Editar`})]}),(0,v.jsx)(`div`,{children:b?(0,v.jsxs)(`div`,{className:`form-wrapper`,children:[(0,v.jsx)(`textarea`,{autoFocus:!0,rows:3,className:`form-control`,defaultValue:e.description,onChange:e=>y(e.target.value),placeholder:`Adicione uma descrição mais detalhada...`}),(0,v.jsxs)(`div`,{style:{display:`flex`,justifyContent:`flex-end`,gap:`var(--space-2)`,marginTop:`var(--space-2)`},children:[(0,v.jsx)(o,{type:`button`,variant:`ghost`,color:`tertiary`,onClick:()=>w(!1),children:`Cancelar`}),(0,v.jsx)(o,{type:`button`,onClick:()=>{a(d.editTask({columnId:r,task:{...e,description:m}})),y(``),w(!1)},children:`Salvar`})]})]}):(0,v.jsx)(i.span,{children:e?.description})})]})]})]})}function T({column:n}){let r=g(),{show:a,openModal:c,closeModal:l}=t(),u=_(e=>e.kanban.draggingTaskId),[f,p]=(0,h.useState)(!1),[S,C]=(0,h.useState)(null),T=(0,h.useCallback)(e=>{e.preventDefault(),u&&S!==n.tasks.length&&C(n.tasks.length)},[n.tasks.length,u,S]),E=(0,h.useCallback)(e=>{C(null)},[]),D=(0,h.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=e.dataTransfer.getData(`taskId`)||u,i=e.dataTransfer.getData(`fromColumn`);if(!t||!i){C(null),r(d.setDraggingTask(null));return}let a=S??n.tasks.length;r(d.moveTaskWithIndex({fromColumnId:i,toColumnId:n.id,taskId:t,destinationIndex:a})),C(null),r(d.setDraggingTask(null))},[r,n.id,n.tasks.length,u,S]),O=e=>t=>{if(t.preventDefault(),t.stopPropagation(),!u)return;let n=t.currentTarget.getBoundingClientRect(),r=n.top+n.height/2,i=t.clientY<r?e:e+1;S!==i&&C(i)};return(0,v.jsxs)(`div`,{className:m.column,onDragOver:T,onDrop:D,onDragLeave:E,children:[(0,v.jsxs)(`div`,{className:m.columnHeader,children:[(0,v.jsx)(y,{column:n,isEditing:f,closeEditing:()=>p(!1)}),(0,v.jsx)(o,{variant:`link`,color:`tertiary`,size:`none`,onClick:()=>p(!0),children:(0,v.jsx)(e,{})})]}),(0,v.jsxs)(`ul`,{className:m.tasks,children:[n.tasks.map((e,t)=>(0,v.jsxs)(`li`,{children:[S===t&&u&&(0,v.jsx)(`div`,{className:x.taskPlaceholder}),(0,v.jsx)(`div`,{onDragOver:O(t),children:(0,v.jsx)(w,{task:e,index:t,columnId:n.id})})]},e.id)),S===n.tasks.length&&u&&(0,v.jsx)(`div`,{className:x.taskPlaceholder})]}),(0,v.jsx)(`div`,{className:m.footer,children:(0,v.jsxs)(o,{fullWidth:!0,variant:`ghost`,color:`tertiary`,size:`none`,align:`left`,onClick:c,children:[(0,v.jsx)(s,{}),(0,v.jsx)(i.span,{children:`Adicionar uma task`})]})}),(0,v.jsx)(b,{columnId:n.id,show:a,closeModal:l})]})}function E({show:e,closeModal:t}){let n=g(),[r,a]=(0,h.useState)(``),[s,c]=(0,h.useState)(!1),[u,f]=(0,h.useState)({title:``}),p=e=>{f(t=>({...t,title:e.trim()?``:`Nome é obrigatório.`}))},m=(0,h.useMemo)(()=>!s||!r.trim()?!0:!!u.title,[s,r,u]),_=()=>{t(),a(``),c(!1),f({title:``})};return(0,v.jsxs)(l,{isOpen:e,onClose:_,onSubmit:()=>{n(d.addColumn({id:crypto.randomUUID(),title:r})),_()},children:[(0,v.jsx)(l.Header,{onClose:t,children:`Adicionar nova Coluna`}),(0,v.jsx)(l.Body,{children:(0,v.jsxs)(`div`,{className:`form-wrapper`,children:[(0,v.jsx)(i.label,{children:`Nome`}),(0,v.jsx)(`input`,{autoFocus:!0,type:`text`,name:`title`,value:r,className:`form-control`,onChange:e=>{a(e.target.value),p(e.target.value),c(!0)}}),u.title&&(0,v.jsx)(i.caption,{className:`is-invalid`,children:u.title})]})}),(0,v.jsxs)(l.Footer,{children:[(0,v.jsx)(o,{type:`button`,variant:`ghost`,color:`tertiary`,onClick:t,children:`Cancelar`}),(0,v.jsx)(o,{type:`submit`,color:`success`,disabled:m,children:`Adicionar`})]})]})}function D(){let e=_(e=>e.kanban.columns),{show:n,openModal:r,closeModal:i}=t();return(0,v.jsxs)(`div`,{className:p.board,children:[e.length>0&&e.map(e=>(0,v.jsx)(T,{column:e},e.id)),(0,v.jsxs)(`div`,{className:p.addColumnBtn,children:[(0,v.jsxs)(o,{color:`primary`,variant:`outline`,onClick:r,style:{whiteSpace:`nowrap`},children:[(0,v.jsx)(s,{}),` Adicionar coluna`]}),(0,v.jsx)(E,{show:n,closeModal:i})]})]})}function O(){return(0,v.jsx)(a,{children:(0,v.jsx)(D,{})})}export{O as default};